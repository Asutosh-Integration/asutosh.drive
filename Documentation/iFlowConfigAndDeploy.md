# Custom Google Drive Adapter

## Table of Contents
1. [Introduction](#introduction)
2. [Prerequisites](#prerequisites)
3. [Configure the Google Drive Sender Adapter](#configure-google-drive-adapter)
4. [Configure the Google Drive Receiver Adapter](#configure-google-drive-adapter)
5. [Deploy iFlow](#deploy-iflow)
6. [Conclusion](#conclusion)

## Introduction
The Custom Google Drive adapter enables SAP Cloud Integration to exchange files with Google Drive. The Adapter will be configured to perform scheduled runs, download files from Google Drive, archive them, add timestamps, and handle large file uploads and downloads.

## Prerequisites
Before proceeding, ensure you have the following prerequisites in place:
- Security Material for Google OAuth 2.0 Authorization Code created. If not then follow this [guide](createSecurityMaterial.md).
- Custom Google Drive adapter deployed in the tenant. If not then follow this [guide](configureAndDeploy.md).
- Download and import sample iFlow from [path](../Integration Flow/GDrive.zip) to your SAP Integration Suite tenant.

## Configure Custom Google Drive Sender Adapter

Once you have created a sender channel and selected the Google Drive sender adapter, you can configure the following attributes.

*General*

| Parameter | Description                                 |
|----------|---------------------------------------------|
| Name | Enter the name of the Google Drive channel. |

*Settings*

| Parameter                                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Choose Operation                                    | Only **Download** operation is supported in Sender Channel.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| File Path                                           | Name of the file to Download. Use of Simple Camel expression is also supported.<br/> ⚠️Caution:<br/> Multiple filenames are not supported.<br/> Please always mention absolute path from the root (`/`).<br/> While using both Simple Expression and constant, Please always mention extension of the file separated by `.`.<br/> ℹ️Note:<br/> Example of supported file paths are below.<br/> `/<rootFolder>/<subFolder>/<filename>.<ext>`, `/<filename>.<ext>`, `${header.filepathwithext}`, `/<rootFolder>/${property.filenamewithext}`<br/>Example of file paths not supported are below.<br/> `<rootFolder>/<filename>.<ext>` (should start with `/` or `${<expression>}`), `/<rootFolder>/<filename>` (extension should be there in the filename) |
| Credential Name                                     | Name of the Oauth2 Authorization Code artifact.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Archive (Optional)                                  | Allow you to specify if you want to Archive the file. Choosing **only** archive (without **Delete**) will not delete the original file (only make a copy of file in the archive path).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Delete (Optional)                                   | Allow you to specify if you want to Delete the file. Choosing only Delete (without **Archive**) will **move the file to trash**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Archive File Path (_Mandatory if Archive selected_) | Specifies the target directory where to move the file.<br/>  ⚠️Caution:<br/> Target folder creation is not supported as of now so always mention the folders which are present in the drive.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Add Timestamp (Optional)                            | Allow you to specify if you want to add timestamp to the archive file name.<br/> e.g. `archiveFilename2023-09-14 17:15:20.217.pdf`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |

*Scheduler*

| Scheduler Option  | Field     | Description                                                                                                                                                     |
|-------------------|-----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Run Once          |           | Specify if you want to run only once.                                                                                                                           |
| Schedule on Day   | On Date   | Specify the date on which you want the operation to be executed.                                                                                                |
|                   | On Time   | Specify the time at which you want the operation to be executed.                                                                                                |
|                   | Every     | Specify a time period (e.g., every hour) in a dedicated time window.                                                                                            |
|                   | Time Zone | Select the time zone that you want the scheduler to use as a reference for the date and time.                                                                   |
| Schedule to Recur | Daily     | Select the time or interval and time zone for the schedule to recur.                                                                                            |
|                   | Weekly    | Select the checkboxes to indicate the days of the week on which the operation has to be executed. Also, specify the time or interval for the schedule to recur. |
|                   | Monthly   | Select the day of the month on which the operation has to be executed. Also, indicate the time or the interval for the schedule to recur.                       |

## Configure Custom Google Drive Receiver Adapter

Once you have created a sender channel and selected the Google Drive receiver adapter, you can configure the following attributes.

*General*

| Parameter | Description                                 |
|----------|---------------------------------------------|
| Name | Enter the name of the Google Drive channel. |

*Settings*

| Parameter                                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|-----------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Choose Operation                                    | Select the type of operation you want to perform.<br/> 1. **Download:** Export the file from the Google Drive.<br/> 2. **Upload:** Import the file to the Google Drive.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| File Path                                           | Name of the filepath to Download/Upload. Use of Simple Camel expression is also supported.<br/> ⚠️Caution:<br/> Multiple filenames are not supported.<br/> Please always mention absolute path from the root (`/`).<br/> While using both Simple Expression and constant, Please always mention extension of the file separated by `.`.<br/> ℹ️Note:<br/> Example of supported file paths are below.<br/> `/<rootFolder>/<subFolder>/<filename>.<ext>`, `/<filename>.<ext>`, `${header.filepathwithext}`, `/<rootFolder>/${property.filenamewithext}`<br/>Example of file paths not supported are below.<br/> `<rootFolder>/<filename>.<ext>` (should start with `/` or `${<expression>}`), `/<rootFolder>/<filename>` (extension should be there in the filename) |
| Credential Name                                     | Name of the Oauth2 Authorization Code artifact.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Archive (Optional)                                  | Allow you to specify if you want to Archive the file. Choosing **only** archive (without **Delete**) will not delete the original file (only make a copy of file in the archive path).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Delete (Optional)                                   | Allow you to specify if you want to Delete the file. Choosing only Delete (without **Archive**) will **move the file to trash**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Archive File Path (_Mandatory if Archive selected_) | Specifies the target directory where to move the file.<br/>  ⚠️Caution:<br/> Target folder creation is not supported as of now so always mention the folders which are present in the drive.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Add Timestamp (Optional)                            | Allow you to specify if you want to add timestamp to the archive file name.<br/> e.g. `archiveFilename2023-09-14 17:15:20.217.pdf`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |


## Deploy iFlow
1. Save your iFlow configuration.
2. Deploy the iFlow to your SAP Integration Suite tenant.
3. Monitor the iFlow for any issues or errors during execution.

## Conclusion
You have successfully configured and deployed a SAP Integration Suite iFlow with a custom Google Drive adapter, enabling scheduled runs, file downloads, archiving, timestamping, and handling large files. Make sure to test the iFlow thoroughly in your tenant to ensure it meets your integration requirements.

